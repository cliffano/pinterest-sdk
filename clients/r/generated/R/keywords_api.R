#' Pinterest REST API
#'
#' Pinterest's REST API
#'
#' The version of the OpenAPI document: 5.12.0
#' Contact: blah+oapicf@cliffano.com
#' Generated by: https://openapi-generator.tech
#'
#' @docType class
#' @title Keywords operations
#' @description KeywordsApi
#' @format An \code{R6Class} generator object
#' @field api_client Handles the client-server communication.
#'
#' @section Methods:
#' \describe{
#' \strong{ CountryKeywordsMetricsGet } \emph{ Get country&#39;s keyword metrics }
#' See keyword metrics for a specified country, aggregated across all of Pinterest. (Definitions are available from the \"Get delivery metrics definitions\" <a href=\"/docs/api/v5/#operation/delivery_metrics/get\">API endpoint</a>).
#'
#' \itemize{
#' \item \emph{ @param } ad_account_id character
#' \item \emph{ @param } country_code character
#' \item \emph{ @param } keywords list( character )
#' \item \emph{ @returnType } \link{KeywordsMetricsArrayResponse} \cr
#'
#'
#' \item status code : 200 | Success
#'
#' \item return type : KeywordsMetricsArrayResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | Unexpected error
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ KeywordsCreate } \emph{ Create keywords }
#' <p>Create keywords for following entity types(advertiser, campaign, ad group or ad).</p> <p>For more information, see <a target=\"_blank\" href=\"https://help.pinterest.com/en/business/article/keyword-targeting\">Keyword targeting</a>.</p> <p><b>Notes:</b></p> <ul style=\"list-style-type: square;\"> <li>Advertisers and campaigns can only be assigned keywords with excluding ('_NEGATIVE').</li> <li>All keyword match types are available for ad groups.</li> </ul> <p>For more information on match types, see <a  target=\"_blank\" href=\"/docs/ads/targeting/#Match\%20type\%20and\%20targeting\%20level\">match type enums</a>.</p> <p><b>Returns:</b></p> <ul style=\"list-style-type: square;\"> <li><p>A successful call returns an object containing an array of new keyword objects and an empty &quot;errors&quot; object array.</p></li> <li><p>An unsuccessful call returns an empty keywords array, and, instead, inserts the entire object with nulled/negated properties into the &quot;errors&quot; object array:</p> <pre class=\"last literal-block\"> { \"keywords\": [], \"errors\": [ { \"data\": { \"archived\": null, \"match_type\": \"EXACT\", \"parent_type\": null, \"value\": \"foobar\", \"parent_id\": null, \"type\": \"keyword\", \"id\": null }, \"error_messages\": [ \"Advertisers and Campaigns only accept excluded targeting attributes.\" ] } } </pre></li> </ul> <p><b>Rate limit</b>: <a href=\"/docs/redoc/#tag/Rate-Limits\">WRITE</a>.</p>
#'
#' \itemize{
#' \item \emph{ @param } ad_account_id character
#' \item \emph{ @param } keywords_request \link{KeywordsRequest}
#' \item \emph{ @returnType } \link{KeywordsResponse} \cr
#'
#'
#' \item status code : 200 | Success
#'
#' \item return type : KeywordsResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | Unexpected error
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ KeywordsGet } \emph{ Get keywords }
#' <p>Get a list of keywords based on the filters provided. If no filter is provided, it will default to the ad_account_id filter, which means it will only return keywords that specifically have parent_id set to the ad_account_id. Note: Keywords can have ad_account_ids, campaign_ids, and ad_group_ids set as their parent_ids. Keywords created through Ads Manager will have their parent_id set to an ad_group_id, not ad_account_id.</p> <p>For more information, see <a target=\"_blank\" href=\"https://help.pinterest.com/en/business/article/keyword-targeting\">Keyword targeting</a>.</p> <p><b>Notes:</b></p> <ul style=\"list-style-type: square;\"> <li>Advertisers and campaigns can only be assigned keywords with excluding ('_NEGATIVE').</li> <li>All keyword match types are available for ad groups.</li> </ul> <p>For more information on match types, see <a target=\"_blank\" href=\"/docs/ads/targeting/#Match\%20type\%20and\%20targeting\%20level\">match type enums</a>.</p> <p><b>Returns:</b></p> <ul style=\"list-style-type: square;\"> <li><p>A successful call returns an object containing an array of new keyword objects and an empty &quot;errors&quot; object array.</p></li> <li><p>An unsuccessful call returns an empty keywords array, and, instead, inserts the entire object with nulled/negated properties into the &quot;errors&quot; object array:</p> <pre class=\"last literal-block\"> { \"keywords\": [], \"errors\": [ { \"data\": { \"archived\": null, \"match_type\": \"EXACT\", \"parent_type\": null, \"value\": \"foobar\", \"parent_id\": null, \"type\": \"keyword\", \"id\": null }, \"error_messages\": [ \"Advertisers and Campaigns only accept excluded targeting attributes.\" ] } } </pre></li> </ul>
#'
#' \itemize{
#' \item \emph{ @param } ad_account_id character
#' \item \emph{ @param } campaign_id character
#' \item \emph{ @param } ad_group_id character
#' \item \emph{ @param } match_types list( \link{MatchType} )
#' \item \emph{ @param } page_size integer
#' \item \emph{ @param } bookmark character
#' \item \emph{ @returnType } \link{KeywordsGet200Response} \cr
#'
#'
#' \item status code : 200 | Success
#'
#' \item return type : KeywordsGet200Response
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | Unexpected error
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ KeywordsUpdate } \emph{ Update keywords }
#' <p>Update one or more keywords' bid and archived fields.</p> <p>Archiving a keyword effectively deletes it - keywords no longer receive metrics and no longer visible within the parent entity's keywords list.</p>
#'
#' \itemize{
#' \item \emph{ @param } ad_account_id character
#' \item \emph{ @param } keyword_update_body \link{KeywordUpdateBody}
#' \item \emph{ @returnType } \link{KeywordsResponse} \cr
#'
#'
#' \item status code : 200 | Success
#'
#' \item return type : KeywordsResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | Unexpected error
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ TrendingKeywordsList } \emph{ List trending keywords }
#' <p>Get the top trending search keywords among the Pinterest user audience.</p> <p>Trending keywords can be used to inform ad targeting, budget strategy, and creative decisions about which products and Pins will resonate with your audience.</p> <p>Geographic, demographic and interest-based filters are available to narrow down to the top trends among a specific audience. Multiple trend types are supported that can be used to identify newly-popular, evergreen or seasonal keywords.</p> <p>For an interactive way to explore this data, please visit <a href=\"https://trends.pinterest.com\">trends.pinterest.com</a>.
#'
#' \itemize{
#' \item \emph{ @param } region \link{TrendsSupportedRegion}
#' \item \emph{ @param } trend_type \link{TrendType}
#' \item \emph{ @param } interests Enum < [animals, architecture, art, beauty, childrens_fashion, design, diy_and_crafts, education, electronics, entertainment, event_planning, finance, food_and_drinks, gardening, health, home_decor, mens_fashion, parenting, quotes, sport, travel, vehicles, wedding, womens_fashion] >
#' \item \emph{ @param } genders Enum < [female, male, unknown] >
#' \item \emph{ @param } ages Enum < [18-24, 25-34, 35-44, 45-49, 50-54, 55-64, 65+] >
#' \item \emph{ @param } normalize_against_group character
#' \item \emph{ @param } limit integer
#' \item \emph{ @returnType } \link{TrendingKeywordsResponse} \cr
#'
#'
#' \item status code : 200 | Success
#'
#' \item return type : TrendingKeywordsResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 400 | Invalid trending keywords request parameters
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | Unexpected error
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' }
#'
#'
#' @examples
#' \dontrun{
#' ####################  CountryKeywordsMetricsGet  ####################
#'
#' library(openapi)
#' var_ad_account_id <- "ad_account_id_example" # character | Unique identifier of an ad account.
#' var_country_code <- "US" # character | Two letter country code (ISO 3166-1 alpha-2)
#' var_keywords <- c("inner_example") # array[character] | Comma-separated keywords
#'
#' #Get country's keyword metrics
#' api_instance <- KeywordsApi$new()
#'
#' # Configure OAuth2 access token for authorization: pinterest_oauth2
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$CountryKeywordsMetricsGet(var_ad_account_id, var_country_code, var_keywordsdata_file = "result.txt")
#' result <- api_instance$CountryKeywordsMetricsGet(var_ad_account_id, var_country_code, var_keywords)
#' dput(result)
#'
#'
#' ####################  KeywordsCreate  ####################
#'
#' library(openapi)
#' var_ad_account_id <- "ad_account_id_example" # character | Unique identifier of an ad account.
#' var_keywords_request <- KeywordsRequest$new(c(KeywordsCommon$new(MatchTypeResponse$new(), "value_example", 123)), "parent_id_example") # KeywordsRequest | 
#'
#' #Create keywords
#' api_instance <- KeywordsApi$new()
#'
#' # Configure OAuth2 access token for authorization: pinterest_oauth2
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$KeywordsCreate(var_ad_account_id, var_keywords_requestdata_file = "result.txt")
#' result <- api_instance$KeywordsCreate(var_ad_account_id, var_keywords_request)
#' dput(result)
#'
#'
#' ####################  KeywordsGet  ####################
#'
#' library(openapi)
#' var_ad_account_id <- "ad_account_id_example" # character | Unique identifier of an ad account.
#' var_campaign_id <- "campaign_id_example" # character | Campaign Id to use to filter the results. (Optional)
#' var_ad_group_id <- "123123123" # character | Ad group Id. (Optional)
#' var_match_types <- c(MatchType$new()) # array[MatchType] | Keyword <a target=\"_blank\" href=\"/docs/ads/targeting/#Match%20type%20and%20targeting%20level\">match type</a> (Optional)
#' var_page_size <- 25 # integer | Maximum number of items to include in a single page of the response. See documentation on <a href='/docs/getting-started/pagination/'>Pagination</a> for more information. (Optional)
#' var_bookmark <- "bookmark_example" # character | Cursor used to fetch the next page of items (Optional)
#'
#' #Get keywords
#' api_instance <- KeywordsApi$new()
#'
#' # Configure OAuth2 access token for authorization: pinterest_oauth2
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$KeywordsGet(var_ad_account_id, campaign_id = var_campaign_id, ad_group_id = var_ad_group_id, match_types = var_match_types, page_size = var_page_size, bookmark = var_bookmarkdata_file = "result.txt")
#' result <- api_instance$KeywordsGet(var_ad_account_id, campaign_id = var_campaign_id, ad_group_id = var_ad_group_id, match_types = var_match_types, page_size = var_page_size, bookmark = var_bookmark)
#' dput(result)
#'
#'
#' ####################  KeywordsUpdate  ####################
#'
#' library(openapi)
#' var_ad_account_id <- "ad_account_id_example" # character | Unique identifier of an ad account.
#' var_keyword_update_body <- KeywordUpdateBody$new(c(KeywordUpdate$new("id_example", "archived_example", 123))) # KeywordUpdateBody | 
#'
#' #Update keywords
#' api_instance <- KeywordsApi$new()
#'
#' # Configure OAuth2 access token for authorization: pinterest_oauth2
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$KeywordsUpdate(var_ad_account_id, var_keyword_update_bodydata_file = "result.txt")
#' result <- api_instance$KeywordsUpdate(var_ad_account_id, var_keyword_update_body)
#' dput(result)
#'
#'
#' ####################  TrendingKeywordsList  ####################
#'
#' library(openapi)
#' var_region <- TrendsSupportedRegion$new() # TrendsSupportedRegion | The geographic region of interest. Only top trends within the specified region will be returned.<br /> The `region` parameter is formatted as ISO 3166-2 country codes delimited by `+`, corresponding to the following geographic areas: - `US` - United States - `CA` - Canada - `DE` - Germany - `FR` - France - `ES` - Spain - `IT` - Italy - `DE+AT+CH` - Germanic countries - `GB+IE` - Great Britain & Ireland - `IT+ES+PT+GR+MT` - Southern Europe - `PL+RO+HU+SK+CZ` - Eastern Europe - `SE+DK+FI+NO` - Nordic countries - `NL+BE+LU` - Benelux - `AR` - Argentina - `BR` - Brazil - `CO` - Colombia - `MX` - Mexico - `MX+AR+CO+CL` - Hispanic LatAm - `AU+NZ` - Australasia
#' var_trend_type <- TrendType$new() # TrendType | The methodology used to rank how trendy a keyword is. - `growing` trends have high upward growth in search volume over the last quarter - `monthly` trends have high search volume in the last month - `yearly` trends have high search volume in the last year - `seasonal` trends have high upward growth in search volume over the last month and exhibit a seasonal recurring pattern (typically annual)
#' var_interests <- c("animals") # array[character] | If set, filters the results to trends associated with the specified interests.<br /> If unset, trends for all interests will be returned.<br /> The list of supported interests is: - `animals` - Animals - `architecture` - Architecture - `art` - Art - `beauty` - Beauty - `childrens_fashion` - Children's Fashion - `design` - Design - `diy_and_crafts` - DIY & Crafts - `education` - Education - `electronics` - Electronics - `entertainment` - Entertainment - `event_planning` - Event Planning - `finance` - Finance - `food_and_drinks` - Food & Drink - `gardening` - Gardening - `health` - Health - `home_decor` - Home Decor - `mens_fashion` - Men's Fashion - `parenting` - Parenting - `quotes` - Quotes - `sport` - Sports - `travel` - Travel - `vehicles` - Vehicles - `wedding` - Wedding - `womens_fashion` - Women's Fashion (Optional)
#' var_genders <- c("female") # array[character] | If set, filters the results to trends among users who identify with the specified gender(s).<br /> If unset, trends among all genders will be returned.<br /> The `unknown` group includes users with unspecified or customized gender profile settings. (Optional)
#' var_ages <- c("18-24") # array[character] | If set, filters the results to trends among users in the specified age range(s).<br /> If unset, trends among all age groups will be returned. (Optional)
#' var_normalize_against_group <- FALSE # character | Governs how the resulting time series data will be normalized to a [0-100] scale.<br /> By default (`false`), the data will be normalized independently for each keyword.  The peak search volume observation in *each* keyword's time series will be represented by the value 100.  This is ideal for analyzing when an individual keyword is expected to peak in interest.<br /> If set to `true`, the data will be normalized as a group.  The peak search volume observation across *all* keywords in the response will be represented by the value 100, and all other values scaled accordingly.  Use this option when you wish to compare relative search volume between multiple keywords. (Optional)
#' var_limit <- 50 # integer | The maximum number of trending keywords that will be returned. Keywords are returned in trend-ranked order, so a `limit` of 50 will return the top 50 trends. (Optional)
#'
#' #List trending keywords
#' api_instance <- KeywordsApi$new()
#'
#' # Configure OAuth2 access token for authorization: pinterest_oauth2
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$TrendingKeywordsList(var_region, var_trend_type, interests = var_interests, genders = var_genders, ages = var_ages, normalize_against_group = var_normalize_against_group, limit = var_limitdata_file = "result.txt")
#' result <- api_instance$TrendingKeywordsList(var_region, var_trend_type, interests = var_interests, genders = var_genders, ages = var_ages, normalize_against_group = var_normalize_against_group, limit = var_limit)
#' dput(result)
#'
#'
#' }
#' @importFrom R6 R6Class
#' @importFrom base64enc base64encode
#' @export
KeywordsApi <- R6::R6Class(
  "KeywordsApi",
  public = list(
    api_client = NULL,
    #' Initialize a new KeywordsApi.
    #'
    #' @description
    #' Initialize a new KeywordsApi.
    #'
    #' @param api_client An instance of API client.
    #' @export
    initialize = function(api_client) {
      if (!missing(api_client)) {
        self$api_client <- api_client
      } else {
        self$api_client <- ApiClient$new()
      }
    },
    #' Get country's keyword metrics
    #'
    #' @description
    #' Get country's keyword metrics
    #'
    #' @param ad_account_id Unique identifier of an ad account.
    #' @param country_code Two letter country code (ISO 3166-1 alpha-2)
    #' @param keywords Comma-separated keywords
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return KeywordsMetricsArrayResponse
    #' @export
    CountryKeywordsMetricsGet = function(ad_account_id, country_code, keywords, data_file = NULL, ...) {
      local_var_response <- self$CountryKeywordsMetricsGetWithHttpInfo(ad_account_id, country_code, keywords, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Get country's keyword metrics
    #'
    #' @description
    #' Get country's keyword metrics
    #'
    #' @param ad_account_id Unique identifier of an ad account.
    #' @param country_code Two letter country code (ISO 3166-1 alpha-2)
    #' @param keywords Comma-separated keywords
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (KeywordsMetricsArrayResponse) with additional information such as HTTP status code, headers
    #' @export
    CountryKeywordsMetricsGetWithHttpInfo = function(ad_account_id, country_code, keywords, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`ad_account_id`)) {
        stop("Missing required parameter `ad_account_id`.")
      }

      if (missing(`country_code`)) {
        stop("Missing required parameter `country_code`.")
      }

      if (missing(`keywords`)) {
        stop("Missing required parameter `keywords`.")
      }

      if (nchar(`ad_account_id`) > 18) {
        stop("Invalid length for `ad_account_id` when calling KeywordsApi$CountryKeywordsMetricsGet, must be smaller than or equal to 18.")
      }
      if (!str_detect(`ad_account_id`, "^\\d+$")) {
        stop("Invalid value for `ad_account_id` when calling KeywordsApi$CountryKeywordsMetricsGet, must conform to the pattern ^\\d+$.")
      }


      if (length(`keywords`) > 2000) {
        stop("Invalid length for `keywords` when calling KeywordsApi$CountryKeywordsMetricsGet, number of items must be less than or equal to 2000.")
      }
      if (length(`keywords`) < 1) {
        stop("Invalid length for `keywords` when calling KeywordsApi$CountryKeywordsMetricsGet, number of items must be greater than or equal to 1.")
      }

      query_params[["country_code"]] <- `country_code`

      # no explore
      query_params[["keywords"]] <- I(paste(lapply(`keywords`, URLencode, reserved = TRUE), collapse = ","))

      local_var_url_path <- "/ad_accounts/{ad_account_id}/keywords/metrics"
      if (!missing(`ad_account_id`)) {
        local_var_url_path <- gsub("\\{ad_account_id\\}", URLencode(as.character(`ad_account_id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "ads:read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response_as_text(), "KeywordsMetricsArrayResponse", loadNamespace("openapi")),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        local_var_resp
      }
    },
    #' Create keywords
    #'
    #' @description
    #' Create keywords
    #'
    #' @param ad_account_id Unique identifier of an ad account.
    #' @param keywords_request 
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return KeywordsResponse
    #' @export
    KeywordsCreate = function(ad_account_id, keywords_request, data_file = NULL, ...) {
      local_var_response <- self$KeywordsCreateWithHttpInfo(ad_account_id, keywords_request, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Create keywords
    #'
    #' @description
    #' Create keywords
    #'
    #' @param ad_account_id Unique identifier of an ad account.
    #' @param keywords_request 
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (KeywordsResponse) with additional information such as HTTP status code, headers
    #' @export
    KeywordsCreateWithHttpInfo = function(ad_account_id, keywords_request, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`ad_account_id`)) {
        stop("Missing required parameter `ad_account_id`.")
      }

      if (missing(`keywords_request`)) {
        stop("Missing required parameter `keywords_request`.")
      }

      if (nchar(`ad_account_id`) > 18) {
        stop("Invalid length for `ad_account_id` when calling KeywordsApi$KeywordsCreate, must be smaller than or equal to 18.")
      }
      if (!str_detect(`ad_account_id`, "^\\d+$")) {
        stop("Invalid value for `ad_account_id` when calling KeywordsApi$KeywordsCreate, must conform to the pattern ^\\d+$.")
      }


      if (!is.null(`keywords_request`)) {
        local_var_body <- `keywords_request`$toJSONString()
      } else {
        body <- NULL
      }

      local_var_url_path <- "/ad_accounts/{ad_account_id}/keywords"
      if (!missing(`ad_account_id`)) {
        local_var_url_path <- gsub("\\{ad_account_id\\}", URLencode(as.character(`ad_account_id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "ads:write"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list("application/json")

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "POST",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response_as_text(), "KeywordsResponse", loadNamespace("openapi")),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        local_var_resp
      }
    },
    #' Get keywords
    #'
    #' @description
    #' Get keywords
    #'
    #' @param ad_account_id Unique identifier of an ad account.
    #' @param campaign_id (optional) Campaign Id to use to filter the results.
    #' @param ad_group_id (optional) Ad group Id.
    #' @param match_types (optional) Keyword <a target=\"_blank\" href=\"/docs/ads/targeting/#Match%20type%20and%20targeting%20level\">match type</a>
    #' @param page_size (optional) Maximum number of items to include in a single page of the response. See documentation on <a href='/docs/getting-started/pagination/'>Pagination</a> for more information. (default value: 25)
    #' @param bookmark (optional) Cursor used to fetch the next page of items
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return KeywordsGet200Response
    #' @export
    KeywordsGet = function(ad_account_id, campaign_id = NULL, ad_group_id = NULL, match_types = NULL, page_size = 25, bookmark = NULL, data_file = NULL, ...) {
      local_var_response <- self$KeywordsGetWithHttpInfo(ad_account_id, campaign_id, ad_group_id, match_types, page_size, bookmark, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Get keywords
    #'
    #' @description
    #' Get keywords
    #'
    #' @param ad_account_id Unique identifier of an ad account.
    #' @param campaign_id (optional) Campaign Id to use to filter the results.
    #' @param ad_group_id (optional) Ad group Id.
    #' @param match_types (optional) Keyword <a target=\"_blank\" href=\"/docs/ads/targeting/#Match%20type%20and%20targeting%20level\">match type</a>
    #' @param page_size (optional) Maximum number of items to include in a single page of the response. See documentation on <a href='/docs/getting-started/pagination/'>Pagination</a> for more information. (default value: 25)
    #' @param bookmark (optional) Cursor used to fetch the next page of items
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (KeywordsGet200Response) with additional information such as HTTP status code, headers
    #' @export
    KeywordsGetWithHttpInfo = function(ad_account_id, campaign_id = NULL, ad_group_id = NULL, match_types = NULL, page_size = 25, bookmark = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`ad_account_id`)) {
        stop("Missing required parameter `ad_account_id`.")
      }

      if (nchar(`ad_account_id`) > 18) {
        stop("Invalid length for `ad_account_id` when calling KeywordsApi$KeywordsGet, must be smaller than or equal to 18.")
      }
      if (!str_detect(`ad_account_id`, "^\\d+$")) {
        stop("Invalid value for `ad_account_id` when calling KeywordsApi$KeywordsGet, must conform to the pattern ^\\d+$.")
      }

      if (nchar(`campaign_id`) > 18) {
        stop("Invalid length for `campaign_id` when calling KeywordsApi$KeywordsGet, must be smaller than or equal to 18.")
      }
      if (!str_detect(`campaign_id`, "^\\d+$")) {
        stop("Invalid value for `campaign_id` when calling KeywordsApi$KeywordsGet, must conform to the pattern ^\\d+$.")
      }

      if (nchar(`ad_group_id`) > 18) {
        stop("Invalid length for `ad_group_id` when calling KeywordsApi$KeywordsGet, must be smaller than or equal to 18.")
      }
      if (!str_detect(`ad_group_id`, "^\\d+$")) {
        stop("Invalid value for `ad_group_id` when calling KeywordsApi$KeywordsGet, must conform to the pattern ^\\d+$.")
      }

      if (length(`match_types`) > 5) {
        stop("Invalid length for `match_types` when calling KeywordsApi$KeywordsGet, number of items must be less than or equal to 5.")
      }
      if (length(`match_types`) < 1) {
        stop("Invalid length for `match_types` when calling KeywordsApi$KeywordsGet, number of items must be greater than or equal to 1.")
      }

      if (`page_size` > 250) {
        stop("Invalid value for `page_size` when calling KeywordsApi$KeywordsGet, must be smaller than or equal to 250.")
      }
      if (`page_size` < 1) {
        stop("Invalid value for `page_size` when calling KeywordsApi$KeywordsGet, must be bigger than or equal to 1.")
      }


      query_params[["campaign_id"]] <- `campaign_id`

      query_params[["ad_group_id"]] <- `ad_group_id`

      # explore
      for (query_item in `match_types`) {
        query_params[["match_types"]] <- c(query_params[["match_types"]], list(`match_types` = query_item))
      }

      query_params[["page_size"]] <- `page_size`

      query_params[["bookmark"]] <- `bookmark`

      local_var_url_path <- "/ad_accounts/{ad_account_id}/keywords"
      if (!missing(`ad_account_id`)) {
        local_var_url_path <- gsub("\\{ad_account_id\\}", URLencode(as.character(`ad_account_id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "ads:read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response_as_text(), "KeywordsGet200Response", loadNamespace("openapi")),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        local_var_resp
      }
    },
    #' Update keywords
    #'
    #' @description
    #' Update keywords
    #'
    #' @param ad_account_id Unique identifier of an ad account.
    #' @param keyword_update_body 
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return KeywordsResponse
    #' @export
    KeywordsUpdate = function(ad_account_id, keyword_update_body, data_file = NULL, ...) {
      local_var_response <- self$KeywordsUpdateWithHttpInfo(ad_account_id, keyword_update_body, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Update keywords
    #'
    #' @description
    #' Update keywords
    #'
    #' @param ad_account_id Unique identifier of an ad account.
    #' @param keyword_update_body 
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (KeywordsResponse) with additional information such as HTTP status code, headers
    #' @export
    KeywordsUpdateWithHttpInfo = function(ad_account_id, keyword_update_body, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`ad_account_id`)) {
        stop("Missing required parameter `ad_account_id`.")
      }

      if (missing(`keyword_update_body`)) {
        stop("Missing required parameter `keyword_update_body`.")
      }

      if (nchar(`ad_account_id`) > 18) {
        stop("Invalid length for `ad_account_id` when calling KeywordsApi$KeywordsUpdate, must be smaller than or equal to 18.")
      }
      if (!str_detect(`ad_account_id`, "^\\d+$")) {
        stop("Invalid value for `ad_account_id` when calling KeywordsApi$KeywordsUpdate, must conform to the pattern ^\\d+$.")
      }


      if (!is.null(`keyword_update_body`)) {
        local_var_body <- `keyword_update_body`$toJSONString()
      } else {
        body <- NULL
      }

      local_var_url_path <- "/ad_accounts/{ad_account_id}/keywords"
      if (!missing(`ad_account_id`)) {
        local_var_url_path <- gsub("\\{ad_account_id\\}", URLencode(as.character(`ad_account_id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "ads:write"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list("application/json")

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "PATCH",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response_as_text(), "KeywordsResponse", loadNamespace("openapi")),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        local_var_resp
      }
    },
    #' List trending keywords
    #'
    #' @description
    #' List trending keywords
    #'
    #' @param region The geographic region of interest. Only top trends within the specified region will be returned.<br /> The `region` parameter is formatted as ISO 3166-2 country codes delimited by `+`, corresponding to the following geographic areas: - `US` - United States - `CA` - Canada - `DE` - Germany - `FR` - France - `ES` - Spain - `IT` - Italy - `DE+AT+CH` - Germanic countries - `GB+IE` - Great Britain & Ireland - `IT+ES+PT+GR+MT` - Southern Europe - `PL+RO+HU+SK+CZ` - Eastern Europe - `SE+DK+FI+NO` - Nordic countries - `NL+BE+LU` - Benelux - `AR` - Argentina - `BR` - Brazil - `CO` - Colombia - `MX` - Mexico - `MX+AR+CO+CL` - Hispanic LatAm - `AU+NZ` - Australasia
    #' @param trend_type The methodology used to rank how trendy a keyword is. - `growing` trends have high upward growth in search volume over the last quarter - `monthly` trends have high search volume in the last month - `yearly` trends have high search volume in the last year - `seasonal` trends have high upward growth in search volume over the last month and exhibit a seasonal recurring pattern (typically annual)
    #' @param interests (optional) If set, filters the results to trends associated with the specified interests.<br /> If unset, trends for all interests will be returned.<br /> The list of supported interests is: - `animals` - Animals - `architecture` - Architecture - `art` - Art - `beauty` - Beauty - `childrens_fashion` - Children's Fashion - `design` - Design - `diy_and_crafts` - DIY & Crafts - `education` - Education - `electronics` - Electronics - `entertainment` - Entertainment - `event_planning` - Event Planning - `finance` - Finance - `food_and_drinks` - Food & Drink - `gardening` - Gardening - `health` - Health - `home_decor` - Home Decor - `mens_fashion` - Men's Fashion - `parenting` - Parenting - `quotes` - Quotes - `sport` - Sports - `travel` - Travel - `vehicles` - Vehicles - `wedding` - Wedding - `womens_fashion` - Women's Fashion
    #' @param genders (optional) If set, filters the results to trends among users who identify with the specified gender(s).<br /> If unset, trends among all genders will be returned.<br /> The `unknown` group includes users with unspecified or customized gender profile settings.
    #' @param ages (optional) If set, filters the results to trends among users in the specified age range(s).<br /> If unset, trends among all age groups will be returned.
    #' @param normalize_against_group (optional) Governs how the resulting time series data will be normalized to a [0-100] scale.<br /> By default (`false`), the data will be normalized independently for each keyword.  The peak search volume observation in *each* keyword's time series will be represented by the value 100.  This is ideal for analyzing when an individual keyword is expected to peak in interest.<br /> If set to `true`, the data will be normalized as a group.  The peak search volume observation across *all* keywords in the response will be represented by the value 100, and all other values scaled accordingly.  Use this option when you wish to compare relative search volume between multiple keywords. (default value: FALSE)
    #' @param limit (optional) The maximum number of trending keywords that will be returned. Keywords are returned in trend-ranked order, so a `limit` of 50 will return the top 50 trends. (default value: 50)
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return TrendingKeywordsResponse
    #' @export
    TrendingKeywordsList = function(region, trend_type, interests = NULL, genders = NULL, ages = NULL, normalize_against_group = FALSE, limit = 50, data_file = NULL, ...) {
      local_var_response <- self$TrendingKeywordsListWithHttpInfo(region, trend_type, interests, genders, ages, normalize_against_group, limit, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' List trending keywords
    #'
    #' @description
    #' List trending keywords
    #'
    #' @param region The geographic region of interest. Only top trends within the specified region will be returned.<br /> The `region` parameter is formatted as ISO 3166-2 country codes delimited by `+`, corresponding to the following geographic areas: - `US` - United States - `CA` - Canada - `DE` - Germany - `FR` - France - `ES` - Spain - `IT` - Italy - `DE+AT+CH` - Germanic countries - `GB+IE` - Great Britain & Ireland - `IT+ES+PT+GR+MT` - Southern Europe - `PL+RO+HU+SK+CZ` - Eastern Europe - `SE+DK+FI+NO` - Nordic countries - `NL+BE+LU` - Benelux - `AR` - Argentina - `BR` - Brazil - `CO` - Colombia - `MX` - Mexico - `MX+AR+CO+CL` - Hispanic LatAm - `AU+NZ` - Australasia
    #' @param trend_type The methodology used to rank how trendy a keyword is. - `growing` trends have high upward growth in search volume over the last quarter - `monthly` trends have high search volume in the last month - `yearly` trends have high search volume in the last year - `seasonal` trends have high upward growth in search volume over the last month and exhibit a seasonal recurring pattern (typically annual)
    #' @param interests (optional) If set, filters the results to trends associated with the specified interests.<br /> If unset, trends for all interests will be returned.<br /> The list of supported interests is: - `animals` - Animals - `architecture` - Architecture - `art` - Art - `beauty` - Beauty - `childrens_fashion` - Children's Fashion - `design` - Design - `diy_and_crafts` - DIY & Crafts - `education` - Education - `electronics` - Electronics - `entertainment` - Entertainment - `event_planning` - Event Planning - `finance` - Finance - `food_and_drinks` - Food & Drink - `gardening` - Gardening - `health` - Health - `home_decor` - Home Decor - `mens_fashion` - Men's Fashion - `parenting` - Parenting - `quotes` - Quotes - `sport` - Sports - `travel` - Travel - `vehicles` - Vehicles - `wedding` - Wedding - `womens_fashion` - Women's Fashion
    #' @param genders (optional) If set, filters the results to trends among users who identify with the specified gender(s).<br /> If unset, trends among all genders will be returned.<br /> The `unknown` group includes users with unspecified or customized gender profile settings.
    #' @param ages (optional) If set, filters the results to trends among users in the specified age range(s).<br /> If unset, trends among all age groups will be returned.
    #' @param normalize_against_group (optional) Governs how the resulting time series data will be normalized to a [0-100] scale.<br /> By default (`false`), the data will be normalized independently for each keyword.  The peak search volume observation in *each* keyword's time series will be represented by the value 100.  This is ideal for analyzing when an individual keyword is expected to peak in interest.<br /> If set to `true`, the data will be normalized as a group.  The peak search volume observation across *all* keywords in the response will be represented by the value 100, and all other values scaled accordingly.  Use this option when you wish to compare relative search volume between multiple keywords. (default value: FALSE)
    #' @param limit (optional) The maximum number of trending keywords that will be returned. Keywords are returned in trend-ranked order, so a `limit` of 50 will return the top 50 trends. (default value: 50)
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (TrendingKeywordsResponse) with additional information such as HTTP status code, headers
    #' @export
    TrendingKeywordsListWithHttpInfo = function(region, trend_type, interests = NULL, genders = NULL, ages = NULL, normalize_against_group = FALSE, limit = 50, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`region`)) {
        stop("Missing required parameter `region`.")
      }

      if (missing(`trend_type`)) {
        stop("Missing required parameter `trend_type`.")
      }







      if (`limit` > 50) {
        stop("Invalid value for `limit` when calling KeywordsApi$TrendingKeywordsList, must be smaller than or equal to 50.")
      }
      if (`limit` < 1) {
        stop("Invalid value for `limit` when calling KeywordsApi$TrendingKeywordsList, must be bigger than or equal to 1.")
      }

      # explore
      for (query_item in `interests`) {
        # validate enum values
        if (!(query_item %in% c("animals", "architecture", "art", "beauty", "childrens_fashion", "design", "diy_and_crafts", "education", "electronics", "entertainment", "event_planning", "finance", "food_and_drinks", "gardening", "health", "home_decor", "mens_fashion", "parenting", "quotes", "sport", "travel", "vehicles", "wedding", "womens_fashion"))) {
          stop("Invalid value for interests when calling KeywordsApi$TrendingKeywordsList. Must be [animals, architecture, art, beauty, childrens_fashion, design, diy_and_crafts, education, electronics, entertainment, event_planning, finance, food_and_drinks, gardening, health, home_decor, mens_fashion, parenting, quotes, sport, travel, vehicles, wedding, womens_fashion].")
        }
        query_params[["interests"]] <- c(query_params[["interests"]], list(`interests` = query_item))
      }

      # explore
      for (query_item in `genders`) {
        # validate enum values
        if (!(query_item %in% c("female", "male", "unknown"))) {
          stop("Invalid value for genders when calling KeywordsApi$TrendingKeywordsList. Must be [female, male, unknown].")
        }
        query_params[["genders"]] <- c(query_params[["genders"]], list(`genders` = query_item))
      }

      # explore
      for (query_item in `ages`) {
        # validate enum values
        if (!(query_item %in% c("18-24", "25-34", "35-44", "45-49", "50-54", "55-64", "65+"))) {
          stop("Invalid value for ages when calling KeywordsApi$TrendingKeywordsList. Must be [18-24, 25-34, 35-44, 45-49, 50-54, 55-64, 65+].")
        }
        query_params[["ages"]] <- c(query_params[["ages"]], list(`ages` = query_item))
      }

      query_params[["normalize_against_group"]] <- `normalize_against_group`

      query_params[["limit"]] <- `limit`

      local_var_url_path <- "/trends/keywords/{region}/top/{trend_type}"
      if (!missing(`region`)) {
        local_var_url_path <- gsub("\\{region\\}", URLencode(as.character(`region`), reserved = TRUE), local_var_url_path)
      }

      if (!missing(`trend_type`)) {
        local_var_url_path <- gsub("\\{trend_type\\}", URLencode(as.character(`trend_type`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "user_accounts:read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response_as_text(), "TrendingKeywordsResponse", loadNamespace("openapi")),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        local_var_resp
      }
    }
  )
)
